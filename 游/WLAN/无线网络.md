[思维导图](https://mubu.com/edit/pXgaYWLzh0)
------
无线网络基础安全与攻防 \- 幕布    

无线网络基础安全与攻防

*   无线网络基础
    *   定义
        *   狭义无线网络
            *   即提到的“无线网络”，基于802.11b/g/n标准的无线局域网（WLAN）
        *   广义无线网络
            *   WPAN：无线个人局域网通信技术
                *   Bluetooth
                *   IrDA（红外）
            *   WLAN
                *   即一般意义的无线网络
            *   WWAN（无线广域网）
                *   GSM
                    *   全球移动通信系统Global System for Mobile Communication。属于二代2G蜂窝移动通信技术
                    *   GSM系统主要由移动台（MS）、移动网子系统（NSS）、基站子系统（BSS）和操作支持子系统（OSS）四部分组成。
                *   CDMA
                    *   码分多址。称为三代移动通信技术，即3G
                    *   原理：CDMA技术的原理是基于扩频技术，即将需传送的具有一定信号带宽信息数据，用一个带宽远大于信号带宽的高速伪随机码进行调制，使原数据信号的带宽被扩展，再经载波调制并发送出去。接收端使用完全相同的伪随机码，与接收的带宽信号作相关处理，把宽带信号换成原信息数据的窄带信号即解扩，以实现信息通信。
                *   其他则还有3G和3.5G等技术
    *   加密与搭建
        *   WEP（Wired Equivalent Privacy）
            *   本意是实现与有线等价的安全程度
            *   原理：WEP 是1999年9月通过的 IEEE 802.11 标准的一部分，使用 RC4(Rivest Cipher) 串流加密技术达到机密性，并使用 CRC-32 验和达到资料正确性。标准的64比特WEP使用40比特的钥匙接上24比特的初向量(initialization vector，IV) 成为 RC4 用的钥匙。在起草原始的 WEP 标准的时候，美国政府在加密技术的输出限制中限制了钥匙的长度，一旦这个限制放宽之后，所有的主要业者都用 104 比特的钥匙作了 128 比特的 WEP 延伸协定。用户输入 128 比特的 WEP 钥匙的方法一般都是用含有 26 个十六进制数 (0-9 和 A-F)的字串来表示，每个字符代表钥匙中的 4 个比特， 4 * 26 = 104 比特，再加上 24 比特的 IV 就成了所谓的 "128 比特 WEP 钥匙"。有些厂商还提供 256 比特的 WEP 系统，就像上面讲的，24 比特是 IV，实际上剩下 232 比特作为保护之用，典型的作法是用 58 个十六进制数来输入，(58 * 4 = 232 比特) + 24 个 IV 比特 = 256 个 WEP 比特
            *   原理设计：包含一个简单的基于挑战与应答的认证协议和一个加密协议，两者均使用RC4加密算法。WEP还包括一个使用32位CRC的校验机制ICV，保护信息不在传输过程中被修改
            *   改进措施
                *   高位WEP（提高位数）
                *   动态WEP（如Cisco的LEAP、已破解）
        *   WPA/WPA2（Wi-Fi Protected Access）
            *   分类
                *   WPA
                    *   WPA-PSK：针对家庭及个人
                    *   WPA-Enterprise：针对商业/企业
                *   WPA2
                    *   作用：用于向后兼容于支持WPA的产品
            *   WPA安全
                *   PSK（预配置共享密钥）
                    *   用于验证 L2TP/IPSec 连接的 Unicode 字符串，可以配置“路由和远程访问”来验证支持预共享密钥的 VPN 连接
                *   TKIP（临时密钥完整性协议）
                    *   WPA对于WEP的改进几乎全部基于SKIP的改进，故放上SKIP特性：
                        *   TKIP是包裹在已有WEP密码外围的一层“外壳”。TKIP由WEP使用的同样的加密引擎和RC4算法组成。不过，TKIP中密码使用的密钥长度为128位。这解决了WEP的第一个问题：过短的密钥长度。
                        *   TKIP的一个重要特性，是它变化每个数据包所使用的密钥。这就是它名称中“动态”的出处。密钥通过将多种因素混合在一起生成，包括基本密钥（即TKIP中所谓的成对瞬时密钥）、发射站的MAC地址以及数据包的序列号。混合操作在设计上将对无线站和接入点的要求减少到最低程度，但仍具有足够的密码强度，使它不能被轻易破译。
                        *   利用TKIP传送的每一个数据包都具有独有的48位序列号，这个序列号在每次传送新数据包时递增，并被用作初始化向量和密钥的一部分。将序列号加到密钥中，确保了每个数据包使用不同的密钥。这解决了WEP的另一个问题，即所谓的“碰撞攻击”。这种攻击发生在两个不同数据包使用同样的密钥时。在使用不同的密钥时，不会出现碰撞。
                        *   以数据包序列号作为初始化向量，还解决了另一个WEP问题，即所谓的“重放攻击（replay attacks）”。由于48位序列号需要数千年时间才会出现重复，因此没有人可以重放来自无线连接的老数据包：由于序列号不正确，这些数据包将作为失序包被检测出来。
*   无线网络攻防要点
    *   基础攻防
        *   MAC地址过滤
            *   突破
                *   1、获得合法MAC地址
                *   2、更改MAC地址伪造身份
                *   3、WPA-PSK连接
        *   关闭SSID
            *   突破
                *   1、Deauth攻击法
                    *   Deauth攻击数据包将合法客户端强制下线，再次连接时截获SSID
                *   2、抓包分析法
                *   3、暴力破解法
        *   无DHCP的无线网络
    *   D.O.S
        *   Auth Flood
            *   身份验证洪水攻击：攻击目标针对处于通过验证、和AP建立关联的关联客户端，通过发送大量伪造的身份验证请求帧来断开AP与其他无线服务的连接
            *   特征：抓包发现大量Authentication数据报文提示
        *   Deauth Flood
            *   取消身份验证洪水攻击/验证阻断洪水攻击：欺骗从AP到客户端单播地址的取消身份验证帧，将客户端转为未关联状态
        *   Association Flood
            *   关联洪水攻击：通过利用大量模仿和伪造的无线客户端关联来填充AP的客户端关联表，从而达到淹没AP的目的
        *   Disassociation Flood
            *   取消关联洪水攻击：类似于Deauth Flood，发送取消关联帧
        *   RF Jamming
            *   射频干扰攻击
    *   VPN
        *   原理略，见“邓”。
        *   关于如何缓解无线网络安全问题
            *   无线通信的广播性质，导致普通的AP安全措施不能真正解决问题。
            *   通常建议为：将无线AP放入企业内部的某一网段中，或建立DMZ。建立防火墙后，通过VPN访问内部资源，无线VPN可以有效提升安全程度。
